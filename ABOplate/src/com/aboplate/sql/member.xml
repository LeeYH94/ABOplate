<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Config 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Member">

	<!--
		bean객체로 받아서 각각 컬럼에 값 넣어줌
		1이면 성공 0이면 실패
	 -->
	<insert id="join" parameterType="memberBean" >
	INSERT INTO MEMBER
	(MEMBER_ID, MEMBER_NAME, MEMBER_EMAIL, MEMBER_PASSWORD, MEMBER_NICKNAME, MEMBER_PREFERENCE_FOOD, MEMBER_REGION)
	VALUES(
	#{member_id}, #{member_name}, #{member_email}, #{member_password}, #{member_nickname}, #{member_preference_food}, #{member_region}
	)
	</insert>

	<!--
		map객체로 받아서 db에 있는지 확인 1이면 성공 0이면 실패
	 -->
	<select id="login" parameterType="map" resultType="_int">
		SELECT COUNT(*) FROM MEMBER
		WHERE MEMBER_ID = #{id} AND MEMBER_PW = #{pw}
	</select>

	<!--
		map객체로 받아서 db에 있는지 확인해서 아이디값이 있으면 리턴
	 -->
	<select id="findId" parameterType="map" resultType="string">
		SELECT member_id FROM MEMBER WHERE member_email = #{email} AND member_name = #{name}
	</select>

	<!--
		map객체로 받아서 db에 있는지 확인해서 1이면 성공 0이면 실패
	 -->
	<update id="updatePw" parameterType="map">
		UPDATE MEMBER SET
		member_pw = #{new_pw}
		WHERE member_id = #{id}
	</update>

	<select id="checkId" parameterType="string" resultType="_int">
		SELECT COUNT(*) FROM MEMBER
		WHERE member_id = #{id}
	</select>

	<select id="checkEmail" parameterType="string" resultType="_int">
		SELECT COUNT(*) FROM MEMBER
		WHERE member_email = #{email}
	</select>

	<update id="recommendStamp" parameterType="string">
		UPDATE MEMBER
		SET stamp = stamp + 10
		WHERE m.member_id = #{id}
	</update>
	
	<select id="getjoinList" parameterType="string" resultType="memberBean">
		SELECT member_preference_food, member_region, member_age_group FROM RESTAURANT
		WHERE member_id = #{session_id}
	</select>

</mapper>
